import numpy as np
import scipy.optimize

ktvals = [0.1, 0.4, 0.7000000000000001, 1.0, 1.3, 1.6, 1.9000000000000001, 2.2, 2.5, 2.8000000000000003]
ul = [46.96, 46.15, 44.35, 41.7, 38.65, 35.88, 33.7, 32.35, 31.34, 30.77]
theory = [12.676691436, 12.619975775999999, 12.531383115999999, 12.419813615999999, 12.2977275, 12.181145056, 12.089646636, 12.046372656, 12.078023596, 12.21486, 12.490702476, 12.942931696, 13.612488396, 14.543873376, 15.785147499999997, 17.387931696, 19.407406956000003, 21.902314336, 24.934954956000002, 28.57119, 32.880440716, 37.935688416000005, 43.81347447600002, 50.593900336000026, 58.3606275, 67.20087753600001, 77.20543207600002, 88.46863281600002]
xvals = [0.1, 0.2, 0.30000000000000004, 0.4, 0.5, 0.6000000000000001, 0.7000000000000001, 0.8, 0.9, 1.0, 1.1, 1.2000000000000002, 1.3, 1.4000000000000001, 1.5, 1.6, 1.7000000000000002, 1.8, 1.9000000000000001, 2.0, 2.1, 2.2, 2.3000000000000003, 2.4000000000000004, 2.5, 2.6, 2.7, 2.8000000000000003]
theorylow = [8.087469918500002, 8.050866296, 7.993748998500001, 7.921951136000001, 7.8436390625, 7.769312376000001, 7.711803918500001, 7.686279776000001, 7.710239278500001, 7.803515000000001, 7.988272758500001, 8.289011616000002, 8.7325638785, 9.348095096000002, 10.167104062500002, 11.223422816000001, 12.553216638500004, 14.194984056000003, 16.189556838500003, 18.5801, 21.412111798500003, 24.733423736000006, 28.59420055850001, 33.04694025600001, 38.146474062500005, 43.94996645600001, 50.51691515850001, 57.90915113600002]
theoryhigh = [17.884955975, 17.8060604, 17.682822775, 17.527625599999997, 17.357804375, 17.1956476, 17.068396775, 17.008246399999997, 17.052343975, 17.24279, 17.626637974999998, 18.255894400000003, 19.187518775, 20.483423600000002, 22.210474375, 24.440489600000003, 27.25024077500001, 30.7214524, 34.94080197500001, 39.99992, 45.99538997500001, 53.02874840000001, 61.20648477500002, 70.64004160000005, 81.44581437500001, 93.74515160000001, 107.66435477500004, 123.33467840000004]


ktvals = np.array(ktvals) # for non theory y values
ul = np.array(ul)
theory = np.array(theory)
theorylow = np.array(theorylow)
theoryhigh = np.array(theoryhigh)
xvals = np.array(xvals) # for theory y values

# print ktvals
# print ul

# print theory
# print theorylow
# print theoryhigh
# xtest = 1.8

# print
# print np.interp(xtest,ktvals,ul)
# print np.interp(xtest,xvals,theorylow)
# print

def fcrossing_main(xtest):
    return (np.interp(xtest,ktvals,ul) - np.interp(xtest,xvals,theory))**2.
def fcrossing_plus(xtest):
    return (np.interp(xtest,ktvals,ul) - np.interp(xtest,xvals,theorylow))**2.
def fcrossing_minus(xtest):
    return (np.interp(xtest,ktvals,ul) - np.interp(xtest,xvals,theoryhigh))**2.


cent = scipy.optimize.minimize(fcrossing_main, 2.5)["x"][0]
high = scipy.optimize.minimize(fcrossing_plus, 2.5)["x"][0]
low = scipy.optimize.minimize(fcrossing_minus, 2.5)["x"][0]
print "yt/ytSM < {:.2f} (+{:.2f} -{:.2f})".format(cent, cent-low, high-cent)
